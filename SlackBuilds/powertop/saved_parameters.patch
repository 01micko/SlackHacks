--- src/parameters/persistent.cpp.orig	2012-05-11 07:05:57.411117280 +0700
+++ src/parameters/persistent.cpp	2012-05-11 07:06:40.776468628 +0700
@@ -129,9 +129,6 @@
 
 //	printf("result size is %i, #parameters is %i \n", (int)past_results.size(), (int)all_parameters.parameters.size());
 
-	if (!global_power_valid())
-		return;
-
 	pathname = get_param_directory(filename);
 
 	file.open(pathname, ios::out);
@@ -140,12 +137,15 @@
 		return;
 	}
 
-	map<string, int>::iterator it;
-
-	for (it = param_index.begin(); it != param_index.end(); it++) {
-		int index;
-		index = it->second;
-		file << it->first << "\t" << setprecision(9) << all_parameters.parameters[index] << "\n";
+	if (global_power_valid())
+	{
+		map<string, int>::iterator it;
+
+		for (it = param_index.begin(); it != param_index.end(); it++) {
+			int index;
+			index = it->second;
+			file << it->first << "\t" << setprecision(9) << all_parameters.parameters[index] << "\n";
+		}	
 	}
 	file.close();
 }
